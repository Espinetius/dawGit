CREATE TABLE suministrador
 (num_sum varchar2(7) NOT NULL,
 nom_sum varchar2(10),
 categoria NUMBER(9),
 ciudad varchar2(7),
 PRIMARY KEY (num_sum)); 
 
CREATE TABLE piezas
 (num_piez varchar2(7) NOT NULL,
 nom_piez varchar2(10),
 color varchar2(15),
 peso NUMBER(4),
 ciudad varchar2(7),
 PRIMARY KEY (num_piez));
  
CREATE TABLE suministro_piezas
(num_sum varchar2(7) NOT NULL,
num_piez varchar2(7) NOT NULL,
cantidad NUMBER(9));

INSERT INTO suministrador VALUES ('S1','Javier',20,'Londres');
INSERT INTO suministrador VALUES ('S2','Juan',10,'París');
INSERT INTO suministrador VALUES ('S3','Blas',30,'París');
INSERT INTO suministrador VALUES ('S4','Carlos',20,'Londres');
INSERT INTO suministrador VALUES ('S5','Andrés',30,'Atenas');

INSERT INTO piezas VALUES ('P1','Tuerca','Rojo',12,'Londres');
INSERT INTO piezas VALUES ('P2','Cerrojo','Verde',17,'París');
INSERT INTO piezas VALUES ('P3','Tornillo','Azul',17,'Roma');
INSERT INTO piezas VALUES ('P4','Rueda','Rojo',14,'Londres');
INSERT INTO piezas VALUES ('P5','Leva','Azul',12,'París');
INSERT INTO piezas VALUES ('P6','Rueda','Rojo',19,'Londres');

INSERT INTO suministro_piezas VALUES ('S1','P1',300);
INSERT INTO suministro_piezas VALUES ('S1','P2',200);
INSERT INTO suministro_piezas VALUES ('S1','P3',400);
INSERT INTO suministro_piezas VALUES ('S1','P4',200);
INSERT INTO suministro_piezas VALUES ('S1','P5',100);
INSERT INTO suministro_piezas VALUES ('S1','P6',100);
INSERT INTO suministro_piezas VALUES ('S2','P1',300);
INSERT INTO suministro_piezas VALUES ('S2','P2',400);
INSERT INTO suministro_piezas VALUES ('S3','P2',200);
INSERT INTO suministro_piezas VALUES ('S4','P2',200);
INSERT INTO suministro_piezas VALUES ('S4','P4',300);
INSERT INTO suministro_piezas VALUES ('S4','P5',400); 

1.
SELECT * FROM SUMINISTRADOR WHERE NUM_SUM = 'S1';
2.
CREATE VIEW BUENOS AS SELECT * FROM SUMINISTRADOR WHERE CATEGORIA >= 10 AND CATEGORIA <= 20;
3.
CREATE VIEW PIROJAS AS SELECT * FROM PIEZAS WHERE COLOR LIKE 'Rojo' AND PESO>=12 ADN PESO<=14;
4.
SELECT COUNT(NUM_SUM) FROM SUMINISTRADOR WHERE CATEGORIA > (SELECT AVG(CATEGORIA) FROM SUMINISTRADOR S WHERE CIUDAD IN (SELECT CIUDAD FROM SUMINISTRADOR S1 WHERE S.CIUDAD=S1.CIUDAD));
5.
SELECT NUM_SUM, NUM_PIEZ FROM SUMINISTRO_PIEZAS WHERE NUM_SUM IN (SELECT S.NUM_SUM FROM SUMINISTRADOR S, SUMINISTRADOR S1 WHERE S.CATEGORIA NOT LIKE 20 AND S.CIUDAD=S1.CIUDAD) GROUP BY NUM_SUM, NUM_PIEZ; 
6.
SELECT NUM_PIEZ FROM PIEZAS WHERE PESO >= 16 AND PESO <= 19;
7.
SELECT NUM_PIEZ, NOM_PIEZ FROM PIEZAS WHERE NOM_PIEZ LIKE 'C%';
8.
SELECT NUM_PIEZ FROM PIEZAS WHERE PESO IN (12,16,17);
9.
SELECT NOM_SUM FROM SUMINISTRADOR WHERE NUM_SUM IN (SELECT NUM_SUM FROM SUMINISTRO_PIEZAS WHERE NUM_PIEZ LIKE 'P2');
10.
SELECT NOM_SUM FROM SUMINISTRADOR WHERE NUM_SUM IN (SELECT NUM_SUM FROM SUMINISTRO_PIEZAS WHERE NUM_PIEZ IN (SELECT NUM_PIEZ FROM PIEZAS WHERE COLOR LIKE 'Rojo'));
11.
SELECT NUM_PIEZ FROM SUMINISTRO_PIEZAS WHERE NUM_SUM IN (SELECT NUM_SUM FROM SUMINISTRO_PIEZAS HAVING MAX(COUNT(NUM_SUM));
SELECT DISTINCT(NUM_PIEZ) FROM SUMINISTRO_PIEZAS WHERE NUM_PIEZ IN (SELECT NUM_PIEZ, COUNT(NUM_PIEZ) FROM SUMINISTRO_PIEZAS GROUP BY NUM_SUM HAVING COUNT(NUM_PIEZ)=1);
12.
SELECT NUM_SUM, NUM_PIEZ FROM SUMINISTRO_PIEZAS WHERE NUM_PIEZ IN (SELECT NUM_PIEZ FROM SUMINISTRO_PIEZAS WHERE NUM_SUM LIKE 'S2') AND NUM_SUM NOT LIKE 'S2';
13.

SELECT NUM_SUM, NUM_PIEZ FROM SUMINISTRO_PIEZAS WHERE NUM_PIEZ IN (SELECT NUM_PIEZ FROM SUMINISTRO_PIEZAS WHERE CANTIDAD > (SELECT CANTIDAD FROM SUMINISTRO_PIEZAS WHERE NUM_SUM LIKE 'S1')); 
14.
SELECT NOM_SUM FROM SUMINISTRADOR WHERE NUM_SUM IN (SELECT NUM_SUM FROM SUMINISTRO_PIEZAS WHERE NUM_PIEZ IN (SELECT NUM_PIEZ FROM PIEZAS));
15.
 
16.
UPDATE PIEZAS SET COLOR = 'Amarillo', PESO = PESO+5, CIUDAD=NULL WHERE NUM_PIEZ LIKE 'P2';
17.
SELECT NUM_PIEZ, NOM_PIEZ FROM PIEZAS WHERE NOM_PIEZ LIKE '%a';
18.
SELECT NUM_PIEZ, NOM_PIEZ FROM PIEZAS WHERE NOM_PIEZ LIKE 'R%' OR NOM_PIEZ LIKE '%o';
