ALTER SESSION SET NLS_DATE_FORMAT='YYYY/MM/DD';
create table emple(emp_no 	NUMBER PRIMARY KEY,
apellido VARCHAR2(50) NOT NULL,
oficio VARCHAR2(30),
dir NUMBER,
fecha_alt DATE,
salario NUMBER,
comision NUMBER,	
dept_no NUMBER);	


create table depart(
dept_no NUMBER,
dnombre VARCHAR2(30),
loc VARCHAR2(30));


INSERT INTO emple VALUES (7369,'SÁNCHEZ','EMPLEADO',7902,'1990/12/17',
                        1040,NULL,20);
INSERT INTO emple VALUES (7499,'ARROYO','VENDEDOR',7698,'1990/02/20',
                        1500,390,30);
INSERT INTO emple VALUES (7521,'SALA','VENDEDOR',7698,'1991/02/22',
                        1625,650,30);
INSERT INTO emple VALUES (7566,'JIMÉNEZ','DIRECTOR',7839,'1991/04/02',
                        2900,NULL,20);
INSERT INTO emple VALUES (7654,'MARTÍN','VENDEDOR',7698,'1991/09/29',
                        1600,1020,30);
INSERT INTO emple VALUES (7698,'NEGRO','DIRECTOR',7839,'1991/05/01',
                        3005,NULL,30);
INSERT INTO emple VALUES (7782,'CEREZO','DIRECTOR',7839,'1991/06/09',
                       2885,NULL,10);
INSERT INTO emple VALUES (7788,'GIL','ANALISTA',7566,'1991/11/09',
                        3000,NULL,20);
INSERT INTO emple VALUES (7839,'REY','PRESIDENTE',NULL,'1991/11/17',
                        4100,NULL,10);
INSERT INTO emple VALUES (7844,'TOVAR','VENDEDOR',7698,'1991/09/08',
                        1350,0,30);
INSERT INTO emple VALUES (7876,'ALONSO','EMPLEADO',7788,'1991/09/23',
                        1430,NULL,20);
INSERT INTO emple VALUES (7900,'JIMENO','EMPLEADO',7698,'1991/12/03',
                        1335,NULL,30);
INSERT INTO emple VALUES (7902,'FERNÁNDEZ','ANALISTA',7566,'1991/12/03',
                        3000,NULL,20);
INSERT INTO emple VALUES (7934,'MUÑOZ','EMPLEADO',7782,'1992/01/23',
                        1690,NULL,10);

INSERT INTO depart VALUES (10,'CONTABILIDAD','SEVILLA');
INSERT INTO depart VALUES (20,'INVESTIGACIÓN','MADRID');
INSERT INTO depart VALUES (30,'VENTAS','BARCELONA');
INSERT INTO depart VALUES (40,'PRODUCCIÓN','BILBAO');

1.
SELECT D.DEPT_NO, COUNT(EMP_NO) AS "TOTAL" FROM DEPART D, EMPLE E WHERE D.DEPT_NO=E.DEPT_NO GROUP BY D.DEPT_NO;
2.
SELECT D.DEPT_NO, COUNT(EMP_NO) AS "TOTAL" FROM DEPART D, EMPLE E WHERE D.DEPT_NO=E.DEPT_NO GROUP BY D.DEPT_NO HAVING COUNT(EMP_NO) > 5;
3.
SELECT D.DEPT_NO, AVG(SALARIO) AS "MEDIA SALARIOS" FROM DEPART D, EMPLE E WHERE D.DEPT_NO=E.DEPT_NO GROUP BY D.DEPT_NO;
4.
SELECT APELLIDO FROM EMPLE E WHERE DEPT_NO IN (SELECT DEPT_NO FROM DEPART D WHERE DNOMBRE LIKE 'VENTAS') AND OFICIO LIKE 'VENDEDOR';
5.
SELECT COUNT(APELLIDO) AS "TOTAL EMPLEADOS" FROM EMPLE E WHERE DEPT_NO IN (SELECT DEPT_NO FROM DEPART D WHERE DNOMBRE LIKE 'VENTAS') AND OFICIO LIKE 'VENDEDOR';
6.
SELECT APELLIDO, OFICIO FROM EMPLE WHERE DEPT_NO = (SELECT DEPT_NO FROM DEPART WHERE DNOMBRE LIKE 'VENTAS');
7.
SELECT DEPT_NO, COUNT(*) AS "TOTAL" FROM EMPLE WHERE OFICIO LIKE 'EMPLEADO' GROUP BY DEPT_NO;
8.
SELECT DEPT_NO FROM EMPLE GROUP BY DEPT_NO HAVING COUNT(EMP_NO) = (SELECT MAX(COUNT(EMP_NO)) FROM EMPLE GROUP BY DEPT_NO);
9.
SELECT DEPT_NO, AVG(SALARIO) AS "MEDIA SALARIOS" FROM EMPLE WHERE SALARIO > (SELECT AVG(SALARIO) FROM EMPLE) GROUP BY DEPT_NO;
10.

16.
SELECT EMP_NO, APELLIDO, OFICIO FROM EMPLE WHERE DEPT_NO IN (SELECT DEPT_NO FROM DEPART WHERE DNOMBRE LIKE 'CONTABILIDAD') ORDER BY APELLIDO;
17.
SELECT COUNT(EMP_NO) AS "EMPLEADOS SIN COMISION"  FROM EMPLE WHERE COMISION IS NULL;
18.
SELECT OFICIO, COUNT(*) AS "EMPLEADOS QUE EMPIECEN POR A" FROM EMPLE WHERE OFICIO LIKE 'A%' GROUP BY OFICIO;
19.
UPDATE EMPLE SET SALARIO = SALARIO*2 WHERE DEPT_NO = 30;
UPDATE EMPLE SET SALARIO = SALARIO/2 WHERE DEPT_NO = 30;
20.
UPDATE EMPLE SET DEPT_NO = 20 WHERE DEPT_NO = 30;
DELETE FROM EMPLE WHERE DEPT_NO = 20;
INSERT INTO emple VALUES (7369,'SÁNCHEZ','EMPLEADO',7902,'1990/12/17',
                        1040,NULL,20);
INSERT INTO emple VALUES (7499,'ARROYO','VENDEDOR',7698,'1990/02/20',
                        1500,390,30);
INSERT INTO emple VALUES (7521,'SALA','VENDEDOR',7698,'1991/02/22',
                        1625,650,30);
INSERT INTO emple VALUES (7566,'JIMÉNEZ','DIRECTOR',7839,'1991/04/02',
                        2900,NULL,20);
INSERT INTO emple VALUES (7654,'MARTÍN','VENDEDOR',7698,'1991/09/29',
                        1600,1020,30);
INSERT INTO emple VALUES (7698,'NEGRO','DIRECTOR',7839,'1991/05/01',
                        3005,NULL,30);
INSERT INTO emple VALUES (7788,'GIL','ANALISTA',7566,'1991/11/09',
                        3000,NULL,20);
INSERT INTO emple VALUES (7844,'TOVAR','VENDEDOR',7698,'1991/09/08',
                        1350,0,30);
INSERT INTO emple VALUES (7876,'ALONSO','EMPLEADO',7788,'1991/09/23',
                        1430,NULL,20);
INSERT INTO emple VALUES (7900,'JIMENO','EMPLEADO',7698,'1991/12/03',
                        1335,NULL,30);
INSERT INTO emple VALUES (7902,'FERNÁNDEZ','ANALISTA',7566,'1991/12/03',
                        3000,NULL,20);
21.
UPDATE EMPLE SET SALARIO = SALARIO*(1.1) WHERE DEPT_NO = 10;
UPDATE EMPLE SET SALARIO = SALARIO/(1.1) WHERE DEPT_NO = 10;
22.
UPDATE DEPART SET LOC = 'ZARAGOZA' WHERE DEPT_NO = 10;
UPDATE DEPART SET LOC = 'SEVILLA' WHERE DEPT_NO = 10;
23.
SELECT COUNT(DISTINCT(OFICIO)) FROM EMPLE WHERE DEPT_NO = 20 OR DEPT_NO = 10;
24.
SELECT DEPT_NO, COUNT(*) FROM EMPLE GROUP BY DEPT_NO HAVING COUNT(*)>4 ORDER BY DEPT_NO;
25.
SELECT DEPT_NO, OFICIO, MAX(SALARIO), SUM(SALARIO) FROM EMPLE WHERE (COMISION IS NULL) OR (COMISION > 0.25*SALARIO) GROUP BY DEPT_NO, OFICIO HAVING SUM(SALARIO) > SUM(SALARIO)/2 ;
26.
SELECT E.EMP_NO AS "EMPLEADO", E.APELLIDO, E.OFICIO, J.EMP_NO AS "JEFE", J.APELLIDO, J.OFICIO FROM EMPLE E, EMPLE J WHERE E.DIR=J.EMP_NO ORDER BY E.APELLIDO; 
27.
SELECT APELLIDO, OFICIO FROM EMPLE WHERE SALARIO IN (SELECT SALARIO FROM EMPLE WHERE SALARIO>(SELECT MIN(SALARIO) FROM EMPLE) AND SALARIO<(SELECT MAX(SALARIO) FROM EMPLE));
28.
SELECT DEPT_NO AS "DEPARTAMENTO", MAX(SALARIO) AS "MAXIMO", APELLIDO FROM EMPLE WHERE SALARIO=(SELECT MAX(SALARIO) FROM EMPLE) GROUP BY DEPT_NO, APELLIDO;
SELECT DEPT_NO AS "DEPARTAMENTO", MIN(SALARIO) AS "MINIMO", APELLIDO FROM EMPLE WHERE SALARIO=(SELECT MIN(SALARIO) FROM EMPLE) GROUP BY DEPT_NO, APELLIDO;
29.
SELECT DNOMBRE, EMPLE.DEPT_NO AS "NÚMERO", APELLIDO, FECHA_ALT FROM EMPLE, DEPART WHERE EMPLE.DEPT_NO=DEPART.DEPT_NO AND FECHA_ALT = (SELECT MIN(FECHA_ALT) FROM EMPLE WHERE EMPLE.DEPT_NO=DEPART.DEPT_NO);
30.
SELECT APELLIDO, OFICIO, DEPT_NO FROM EMPLE E WHERE SALARIO=(SELECT MAX(SALARIO) FROM EMPLE E2 WHERE E.DEPT_NO=E2.DEPT_NO GROUP BY DEPT_NO HAVING AVG(SALARIO) IN (SELECT MAX(AVG(SALARIO)) FROM EMPLE GROUP BY DEPT_NO));