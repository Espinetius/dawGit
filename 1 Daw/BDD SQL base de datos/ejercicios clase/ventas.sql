	CREATE TABLE PEDIDOS 
    		(CODIGO      		NUMBER(6) PRIMARY KEY,
    		NUMPEDIDO			NUMBER(6),
    		FECHAPEDIDO    		VARCHAR2(10),
    		CLIE            	NUMBER(5),
    		REP             	NUMBER(3),
    		FAB             	VARCHAR2(3),
    		PRODUCTO        	VARCHAR2(5),
    		CAN             	NUMBER(3),
    		IMPORTE         	NUMBER(7)
	);
		
	CREATE TABLE CLIENTES
                 (NUMCLIE	NUMBER(5) PRIMARY KEY,
                  EMPRESA	VARCHAR2(20),
                  REPCLIE	NUMBER(3),
                  LIMITECREDITO	NUMBER(6)
	);

	CREATE TABLE empleados
                 (NUMEMP	NUMBER(3) PRIMARY KEY,
                  NOMBRE  VARCHAR2(20),
                  EDAD    NUMBER(2),
                  OFICINA	NUMBER(3),
                  TITULO  VARCHAR2(20),
                  CONTRATO	VARCHAR2(10),
                  JEFE  NUMBER(3),
                  CUOTA	NUMBER(6),
                  VENTAS	NUMBER(6) 
	);

	CREATE TABLE PRODUCTOS
                 (	IDFAB	VARCHAR2(3),
					IDPRODUCTO	VARCHAR2(5),
					DESCRIPCION	VARCHAR2(20),
					PRECIO	NUMBER(4),
					EXISTENCIAS	NUMBER(3),
					CONSTRAINT PK_PRODUCTOS PRIMARY KEY  (IDFAB, IDPRODUCTO));
 
	CREATE TABLE OFICINAS 
                 (OFICINA        NUMBER(3) PRIMARY KEY,
                  CIUDAD         VARCHAR2(15),
                  REGION         VARCHAR2(10),
                  DIR            NUMBER(3),
                  OBJETIVO       NUMBER(6),
                  VENTAS         NUMBER(7)	
	);

	INSERT INTO EMPLEADOS VALUES (101, 'Antonio Viguer', 45, 12, 'representante', '1986/10/20', 104, 300000, 305000);
	INSERT INTO EMPLEADOS VALUES (102,'Alvaro Jaumes', 48, 21, 'representante', '1986/12/10', 108, 350000, 474000);
	INSERT INTO EMPLEADOS VALUES (103, 'Juan Rovira', 29,12,'representante', '1987/03/01', 104, 275000, 286000);
	INSERT INTO EMPLEADOS VALUES (104, 'Jose Gonzalez', 33, 12, 'dir ventas', '1987/05/19', 106, 200000, 143000);
	INSERT INTO EMPLEADOS VALUES (105, 'Vicente Pantalla', 37,13,'representante', '1988/06/14', 104, 350000, 368000);
	INSERT INTO EMPLEADOS VALUES (106, 'Luis Antonio', 52, 11, 'dir general', '1988/11/14', 106, 275000, 299000);
	INSERT INTO EMPLEADOS VALUES (107, 'Jorge Gutierrez', 49, 22, 'representante', '1988/11/14', 108, 300000, 186000);
	INSERT INTO EMPLEADOS VALUES (108,'Ana bustamante', 62, 21, 'dir ventas', '1989/10/12', 106, 350000, 361000);
	INSERT INTO EMPLEADOS VALUES (109,'Maria Sunta', 31, 11, 'representante', '1989/10/12', 106, 300000, 392000 );
	INSERT INTO EMPLEADOS VALUES (110, 'Juan Victor', 41, null , 'representante', '1990/01/13', 104, null , 76000);

	INSERT INTO OFICINAS VALUES (11, 'Valencia', 'este', 106, 575000, 693000);
	INSERT INTO OFICINAS VALUES (12, 'Alicante', 'este', 104, 800000, 735000);
	INSERT INTO OFICINAS VALUES (13, 'Castellon', 'este', 105, 350000, 368000);
	INSERT INTO OFICINAS VALUES (21, 'Badajoz', 'oeste', 108, 725000, 836000);
	INSERT INTO OFICINAS VALUES (22, 'A Coruna', 'oeste', 108, 300000, 186000);
	INSERT INTO OFICINAS VALUES (23, 'Madrid', 'centro', 108,null ,null );
	INSERT INTO OFICINAS VALUES (24, 'Madrid', 'centro', 108, 250000, 150000);
	INSERT INTO OFICINAS VALUES (26, 'Pamplona', 'norte',null, null ,null );
	INSERT INTO OFICINAS VALUES (28, 'Valencia', 'este', null, 900000, 0);

	INSERT INTO clientes VALUES (2101, 'Luis Garcia Anton', 106, 65000);
	INSERT INTO clientes VALUES (2102, 'Alvaro Rodriguez', 101, 65000 );
	INSERT INTO clientes VALUES (2103, 'Jaime Llorens',105, 50000);
	INSERT INTO clientes VALUES (2105, 'Antonio Canales',101, 45000);
	INSERT INTO clientes VALUES (2106, 'Juan Suarez',102,65000 );
	INSERT INTO clientes VALUES (2107, 'Julian Lopez',110,35000 );
	INSERT INTO clientes VALUES (2108, 'Julia Antequera',109,55000 );
	INSERT INTO clientes VALUES (2109, 'Alberto Juanes',103,25000 );
	INSERT INTO clientes VALUES (2111, 'Cristobal Garcia',103,50000 );
	INSERT INTO clientes VALUES (2112, 'Maria Silva',108, 50000);
	INSERT INTO clientes VALUES (2113, 'Luisa Maron',104,20000 );
	INSERT INTO clientes VALUES (2114, 'Cristina Bulini',102,20000 );
	INSERT INTO clientes VALUES (2115, 'Vicente Martinez',101, 20000);
	INSERT INTO clientes VALUES (2117, 'Carlos Tena',106, 35000);
	INSERT INTO clientes VALUES (2118, 'Junipero Alvarez',108,60000 );
	INSERT INTO clientes VALUES (2119, 'Salomon Bueno',109, 25000);
	INSERT INTO clientes VALUES (2120, 'Juan Malo',102, 50000);
	INSERT INTO clientes VALUES (2121, 'Vicente Rios',103,45000 );
	INSERT INTO clientes VALUES (2122, 'Jose Marchante',105,30000 );
	INSERT INTO clientes VALUES (2123, 'Jose Libros',102, 40000);
	INSERT INTO clientes VALUES (2124, 'Juan Bolto',107,40000 );

	INSERT INTO productos VALUES ('aci', '41001', 'arandela', 58, 277);
	INSERT INTO productos VALUES ('aci', '41002', 'bisagra',80 , 167);
	INSERT INTO productos VALUES ('aci', '41003', 'art t3', 112, 207);
	INSERT INTO productos VALUES ('aci', '41004', 'art t4', 123, 139);
	INSERT INTO productos VALUES ('aci', '4100x', 'junta', 26, 37);
	INSERT INTO productos VALUES ('aci', '4100y', 'extractor',2888 , 25);
	INSERT INTO productos VALUES ('aci', '4100z', 'mont',2625 , 28);
	INSERT INTO productos VALUES ('bic', '41003', 'manivela',652 , 3);
	INSERT INTO productos VALUES ('bic', '41089', 'rodamiento', 225,78 );
	INSERT INTO productos VALUES ('bic', '41672', 'plato', 180, 0);
	INSERT INTO productos VALUES ('fea', '112', 'cubo', 148, 115);
	INSERT INTO productos VALUES ('fea', '114', 'cubo', 243, 15);
	INSERT INTO productos VALUES ('imm', '773c', 'reostato',975 , 28);
	INSERT INTO productos VALUES ('imm', '775c', 'reostato 2', 1425, 5);
	INSERT INTO productos VALUES ('imm', '779c', 'reostato 3', 1875, 0);
	INSERT INTO productos VALUES ('imm', '887h', 'caja clavos', 54,223 );
	INSERT INTO productos VALUES ('imm', '887p', 'perno', 25, 24);
	INSERT INTO productos VALUES ('imm', '887x', 'manivela',475 ,32 );
	INSERT INTO productos VALUES ('qsa', 'xk47', 'red',355 ,38 );
	INSERT INTO productos VALUES ('qsa', 'xk48', 'red',134 ,203 );
	INSERT INTO productos VALUES ('qsa', 'xk48a', 'red', 117, 37);
	INSERT INTO productos VALUES ('rei', '2a44g', 'pas',350 , 14);
	INSERT INTO productos VALUES ('rei', '2a44l', 'bomba l',4500 , 12);
	INSERT INTO productos VALUES ('rei', '2a44r', 'bomba r', 4500, 12);
	INSERT INTO productos VALUES ('rei', '2a45c', 'junta', 79,210 );

	INSERT INTO pedidos VALUES (1 ,110036 ,'1997/01/02',2107 ,110 ,'aci','4100z',9 ,22500 );
	INSERT INTO pedidos VALUES (2 ,110036 ,'1997/01/02',2117 , 106,'rei','2a44l', 7,31500 );
	INSERT INTO pedidos VALUES (3 ,112963 ,'1997/05/10',2103 ,105 ,'aci','41004',28 ,3276 );
	INSERT INTO pedidos VALUES (4 ,112968 ,'1990/01/11',2102 ,101 ,'aci','41004',34 , 3978);
	INSERT INTO pedidos VALUES (5 ,112975 ,'1997/02/11',2111 ,103 ,'rei','2a44g',6 ,2100 );
	INSERT INTO pedidos VALUES (6 ,112979 ,'1989/10/12',2114 ,108 ,'aci','4100z', 6, 15000);
	INSERT INTO pedidos VALUES (7 ,112983 ,'1997/05/10',2103 ,105 ,'aci','41004', 6,702 );
	INSERT INTO pedidos VALUES (8 ,112987 ,'1997/01/01',2103 , 105,'aci','4100y', 11, 27500);
	INSERT INTO pedidos VALUES (9 ,112989 ,'1997/12/10',2101 , 106,'fea','114', 6, 1458);
	INSERT INTO pedidos VALUES (10 ,112992 ,'1990/04/15',2118 ,108 ,'aci','41002',10 , 760);
	INSERT INTO pedidos VALUES (11 ,112993 ,'1997/04/15',2106 ,102 ,'rei','2a45c',24 , 1896);
	INSERT INTO pedidos VALUES (12 ,112997 ,'1997/03/10',2124 ,107 ,'bic','41003',1 , 652);
	INSERT INTO pedidos VALUES (13 ,11303 ,'1997/04/04',2108 , 109,'imm','779c', 3, 5625);
	INSERT INTO pedidos VALUES (14 ,113007 ,'1997/02/05',2112 ,108 ,'imm','773c', 3, 2925);
	INSERT INTO pedidos VALUES (15 ,113012 ,'1997/01/01',2111 , 105,'aci','41003',35 , 3745);
	INSERT INTO pedidos VALUES (16 ,113013 ,'1997/05/05',2118 , 108,'bic','41003',1 , 652);
	INSERT INTO pedidos VALUES (17 ,113024 ,'1997/08/06',2114 ,108 ,'qsa','xk47', 20,7100 );
	INSERT INTO pedidos VALUES (18 ,113027 ,'1997/02/05',2103 ,105 ,'aci','41002',54 , 4104);
	INSERT INTO pedidos VALUES (19 ,113034 ,'1997/11/05',2107 ,110 ,'rei','2a45c', 8,632 );
	INSERT INTO pedidos VALUES (20 ,113042 ,'1997/01/01',2113 ,101 ,'rei','2a44r', 5, 22500);
	INSERT INTO pedidos VALUES (21 ,113045 ,'1997/07/02',2112 , 108,'rei','2a44r', 10, 45000);
	INSERT INTO pedidos VALUES (22 ,113048 ,'1997/02/02',2120 , 102,'imm','779c', 2, 3750);
	INSERT INTO pedidos VALUES (23 ,113049 ,'1997/04/04',2118 , 108,'qsa','xk47',2 , 776);
	INSERT INTO pedidos VALUES (24 ,113051 ,'1997/07/06',2118 , 108,'qsa','xk47',4 , 1420);
	INSERT INTO pedidos VALUES (25 ,113055 ,'1989/04/01',2108 , 101,'aci','4100x',6 , 150);
	INSERT INTO pedidos VALUES (26 ,113057 ,'1997/11/01',2111 , 103,'aci','4100x',24 , 600);
	INSERT INTO pedidos VALUES (27 ,113058 ,'1989/07/04',2108 , 109,'fea','112',10 , 1480);
	INSERT INTO pedidos VALUES (28 ,113062 ,'1997/07/04',2124 ,107 ,'bic','41003',10 , 2430);
	INSERT INTO pedidos VALUES (29 ,113065 ,'1997/06/03',2106 , 102,'qsa','xk47', 6, 2130);
	INSERT INTO pedidos VALUES (30 ,113069 ,'1997/08/01',2109 , 107,'imm','773c', 22, 31350);

	ALTER TABLE PEDIDOS ADD CONSTRAINT FK_PEDIDOS_CLIE FOREIGN KEY  (CLIE) REFERENCES CLIENTES (NUMCLIE);
	ALTER TABLE PEDIDOS ADD CONSTRAINT FK_PEDIDOS_REP FOREIGN KEY  (REP) REFERENCES empleados (NUMEMP);
	ALTER TABLE PEDIDOS ADD CONSTRAINT FK_PEDIDOS_PRODUCTOS FOREIGN KEY (FAB,PRODUCTO) REFERENCES PRODUCTOS (IDFAB,IDPRODUCTO);

	ALTER TABLE CLIENTES ADD CONSTRAINT FK_CLIENTES_REPARTIDORES FOREIGN KEY  (REPCLIE) REFERENCES empleados (NUMEMP);

	ALTER TABLE EMPLEADOS ADD CONSTRAINT FK_REP_REP FOREIGN KEY  (JEFE) REFERENCES empleados (NUMEMP);
	ALTER TABLE EMPLEADOS ADD CONSTRAINT FK_REP_OFICINAS FOREIGN KEY  (OFICINA) REFERENCES OFICINAS (OFICINA);

	ALTER TABLE OFICINAS ADD 	CONSTRAINT FK_OFI_REP FOREIGN KEY  (DIR) REFERENCES empleados (NUMEMP);

1.
SELECT CODIGO, NUMPEDIDO, FECHAPEDIDO FROM PEDIDOS WHERE IMPORTE<20000;
2.
SELECT * FROM OFICINAS ORDER BY CIUDAD;
3.
SELECT COUNT(DESCRIPCION) AS "TOTAL CUBOS" FROM PRODUCTOS WHERE DESCRIPCION='cubo';
4.
SELECT CODIGO, NUMPEDIDO, MIN(IMPORTE) AS "IMPORTE MENOR" FROM PEDIDOS WHERE IMPORTE=(SELECT MIN(IMPORTE) FROM PEDIDOS) GROUP BY CODIGO, NUMPEDIDO;
5.
SELECT AVG(IMPORTE) AS "MEDIA DE IMPORTE" FROM PEDIDOS;
6.
SELECT * FROM OFICINAS WHERE CIUDAD LIKE 'M%';
7.
SELECT * FROM OFICINAS WHERE CIUDAD LIKE '%a';
8.
SELECT COUNT(*) AS "LOS QUE VIVEN EN ALICANTE" FROM OFICINAS, EMPLEADOS WHERE OFICINAS.OFICINA=EMPLEADOS.OFICINA AND OFICINAS.CIUDAD='Alicante';
SELECT COUNT(*) AS "LOS QUE VIVEN EN ALICANTE" FROM OFICINAS, EMPLEADOS WHERE OFICINAS.OFICINA=EMPLEADOS.OFICINA AND CIUDAD='Alicante' AND TITULO='representante';
9.
SELECT DISTINCT(NUMCLIE) ,EMPRESA FROM CLIENTES, PEDIDOS WHERE PEDIDOS.CLIE=CLIENTES.NUMCLIE AND PEDIDOS.PRODUCTO='41004';
10.
SELECT NUMEMP, NOMBRE, EDAD FROM EMPLEADOS WHERE OFICINA IS NULL;
11.
SELECT * FROM PEDIDOS WHERE FAB='imm' ORDER BY PRODUCTO, CODIGO;
12.
SELECT VENTAS AS"OFICINA QUE VENDE MAS" FROM OFICINAS WHERE VENTAS=(SELECT MAX(VENTAS) FROM OFICINAS WHERE CIUDAD='Madrid'); 
13.
SELECT VENTAS AS"OFICINA QUE VENDE MENOS" FROM OFICINAS WHERE VENTAS=(SELECT MIN(VENTAS) FROM OFICINAS WHERE CIUDAD='Madrid'); 
14.
SELECT AVG(EDAD) AS "MEDIA EDAD" FROM EMPLEADOS;
15
SELECT CODIGO, NUMPEDIDO, SUM(IMPORTE) FROM PEDIDOS, CLIENTES WHERE CLIENTES.NUMCLIE=PEDIDOS.CLIE AND EMPRESA='Cristobal Garcia'GROUP BY CODIGO, NUMPEDIDO;
16.
SELECT * FROM OFICINAS WHERE CIUDAD != 'Madrid';
17.
SELECT NOMBRE, EDAD, NUMEMP FROM EMPLEADOS, OFICINAS WHERE OFICINAS.OFICINA=EMPLEADOS.OFICINA AND REGION='este' AND NUMEMP BETWEEN 106 AND 110;
18. 
SELECT DISTINCT CODIGO, DESCRIPCION, IMPORTE, EMPRESA FROM PEDIDOS, CLIENTES, PRODUCTOS WHERE CLIENTES.NUMCLIE=PEDIDOS.CLIE AND PEDIDOS.PRODUCTO=PRODUCTOS.IDPRODUCTO AND EMPRESA='Juan Suarez';
DROP TABLE CLIENTES;
DROP TABLE EMPLEADOS;
DROP TABLE OFICINAS;
DROP TABLE PEDIDOS;
DROP TABLE PRODUCTOS;